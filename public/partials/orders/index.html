<div ng-controller="OrderController as orders">

  <h3>{{home.currentUser ? 'All Orders' : 'Hello, please sign in below to view orders'}}</h3>
  <a ng-hide="home.currentUser" ui-sref="login">Login</a>

  <label ng-show="home.currentUser">Search Orders:
    <input type="search" ng-model="searchBox">
  </label>

  <div id="orders_to_display" ng-show="home.currentUser.admin">
    <h4>Orders to display</h4>
    <div>
      <label><input type="radio" ng-model="display" value="3"> Orders In Progress</label>
      <label><input type="radio" ng-model="display" value="4"> Shipped Orders</label>
      <label><input type="radio" ng-model="display" value="5"> Canceled Orders</label>
    </div>
  </div>

  <table ng-show="home.currentUser" class="order_list">
    <thead>
      <th>Dentist</th>
      <th>Patient</th>
      <th>Total</th>
      <th></th>
      <th>Due Date</th>
      <th>Status</th>
      <th>Remove</th>
    </thead>
    <tbody>
      <tr class="order" ng-repeat='order in all_orders | orderBy: ["due_date", "dentist_name"] | filter: hideOrders() | filter: searchBox' ng-style="{'background': (order.due_date | DueDate)}">
        <td>{{order.dentist_name}}</td>
        <td>{{order.patient_name}}</td>
        <td>{{order.total | currency}}</td>
        <td ng-click="orders.get_order(order)" class="clickable">View Order</td>
        <td>{{order.due_date | date : format : short}}</td>
        <td>{{order.order_status.name}}<br><select ng-model="order.order_status" ng-options="status as status.name for status in orders.all_statuses">
        </select></td>
        <td ng-show="home.currentUser.admin" ng-click="orders.delete_order(order)" class="clickable">X</td>
        <br>
      </tr>
    </tbody>
  </table>

  <div ng-controller="DentistController as dentists" ng-show="home.currentUser.admin">

    <form ng-submit="orders.new_order(order)">
      <label>Dentist
        <select ng-model="order.dentist" ng-options="dentist as dentist.name for dentist in dentists.all_dentists | filter : {name: '!admin'}">
        </select>
      </label>

      <label>Patient Name
        <input type="text" ng-model="order.patient_name" required>
      </label>

      <label>Due Date
        <input type="date" ng-model="order.due_date" required>
      </label>

      <button type="submit" name="button">Create New Order</button>
    </form>

  </div>

  <h4 style="color:red; text-align: center">{{auth.flash}}</h4>

  <h4 ui-sref="new_dentist" ng-show="home.currentUser.admin" style="text-align:center" class="clickable">Create new dentist</h4>

</div>
